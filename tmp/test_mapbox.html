<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>FMM Mapbox 3D Viewer</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet" />
<style>
  body { margin: 0; padding: 0; }
  #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  #info { position: absolute; top: 12px; left: 12px; background: rgba(0, 0, 0, 0.55); color: #fff; padding: 8px 12px; font-family: sans-serif; font-size: 13px; border-radius: 4px; }
  #legend { position: absolute; left: 12px; bottom: 20px; background: rgba(0, 0, 0, 0.55); color: #fff; padding: 10px 12px; font-family: sans-serif; font-size: 12px; border-radius: 4px; width: 140px; box-shadow: 0 0 8px rgba(0, 0, 0, 0.25); }
  #legend .title { font-weight: 600; margin-bottom: 6px; }
  #legend .scale { height: 10px; border-radius: 6px; background: linear-gradient(90deg, #00ffd5 0%, #7a66ff 50%, #ff1f6b 100%); margin-bottom: 6px; }
  #legend .labels { display: flex; justify-content: space-between; width: 100%; }
  #legend .labels span { opacity: 0.9; }
  .mapboxgl-popup-content { background: rgba(22, 32, 40, 0.88); color: #fff; font-family: sans-serif; font-size: 12px; padding: 10px 12px; border-radius: 6px; box-shadow: 0 0 8px rgba(0, 0, 0, 0.3); }
  .mapboxgl-popup-tip { border-top-color: rgba(22, 32, 40, 0.88) !important; }
  .mapboxgl-popup.static-route-popup .mapboxgl-popup-content { border: 1px solid rgba(0, 255, 213, 0.6); }
  .mapboxgl-popup.static-route-popup .mapboxgl-popup-tip { border-top-color: rgba(22, 32, 40, 0.88) !important; }
</style>
</head>
<body>
<div id="map"></div>
<div id="info">Scroll to zoom • Left mouse to pan • Right mouse or Ctrl+drag to tilt <br/>Color encodes "cumu_prob"</div>
<div id="legend">
  <div class="title">累计概率</div>
  <div class="scale"></div>
  <div class="labels"><span>低</span><span>中</span><span>高</span></div>
</div>
<script>
  mapboxgl.accessToken = "test-token";
  const routeGeojson = {"type": "FeatureCollection", "features": [{"type": "Feature", "properties": {"id": "1", "cumu_prob": null, "duration": "10 \u2026(254 values)", "timestamp": "2.02301061813e+13 \u2026(255 values)", "point_count": 255, "label_lon": 110.322727147, "label_lat": 19.8866257169}, "geometry": {"type": "LineString", "coordinates": [[110.332225665, 19.9805539205], [110.332225665, 19.9805539205], [110.332225615, 19.9805460275], [110.332225615, 19.9805460275], [110.332225553, 19.9805360844], [110.332225553, 19.9805360844], [110.332225547, 19.9805350656], [110.332225547, 19.9805350656], [110.332225547, 19.9805350656], [110.332225547, 19.9805350656], [110.332222908, 19.9801140766], [110.332222908, 19.9801140766], [110.332222908, 19.9801140766], [110.33222591, 19.9788900393], [110.332227643, 19.9784528836], [110.332227643, 19.9784528836], [110.332229331, 19.9780269498], [110.332229331, 19.9780269498], [110.33222947, 19.9779918909], [110.33222947, 19.9779918909], [110.332230208, 19.9778058898], [110.332233172, 19.9769202117], [110.332233172, 19.9769202117], [110.332214557, 19.9756163347], [110.332214557, 19.9756163347], [110.332803244, 19.9744977246], [110.333809428, 19.974663431], [110.334918528, 19.9749548529], [110.334918528, 19.9749548529], [110.337018356, 19.9754995127], [110.337532006, 19.9756319933], [110.337532006, 19.9756319933], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.339960027, 19.9717122988], [110.339960027, 19.9717122988], [110.340044803, 19.9685721308], [110.340044803, 19.9685721308], [110.340044803, 19.9685721308], [110.340044803, 19.9685721308], [110.340073006, 19.9640289913], [110.340073006, 19.9640289913], [110.340073006, 19.9640289913], [110.340086602, 19.9601463225], [110.340142666, 19.9586507626], [110.340322327, 19.9573835346], [110.340322327, 19.9573835346], [110.340947407, 19.9545457044], [110.341307846, 19.9531440739], [110.341307846, 19.9531440739], [110.342008584, 19.9503186937], [110.342008584, 19.9503186937], [110.342008584, 19.9503186937], [110.342749567, 19.9459686991], [110.342749567, 19.9459686991], [110.343062825, 19.9436590071], [110.343350615, 19.9420196765], [110.343350615, 19.9420196765], [110.343574436, 19.9395927816], [110.343574436, 19.9395927816], [110.343880789, 19.9360915102], [110.343880789, 19.9360915102], [110.344352179, 19.9338106031], [110.344352179, 19.9338106031], [110.344474275, 19.9311102775], [110.344474275, 19.9311102775], [110.344474275, 19.9311102775], [110.342892496, 19.9265965046], [110.342482289, 19.9257971027], [110.342482289, 19.9257971027], [110.3413075, 19.9234624], [110.3413075, 19.9234624], [110.339820063, 19.9203734127], [110.339820063, 19.9203734127], [110.339820063, 19.9203734127], [110.339820063, 19.9203734127], [110.338420788, 19.9178935672], [110.338420788, 19.9178935672], [110.338420788, 19.9178935672], [110.337668873, 19.9165360844], [110.337668873, 19.9165360844], [110.337668873, 19.9165360844], [110.336644585, 19.9126589329], [110.336800268, 19.9116193346], [110.336800268, 19.9116193346], [110.336800268, 19.9116193346], [110.336582924, 19.9104301508], [110.336582924, 19.9104301508], [110.336582924, 19.9104301508], [110.336582924, 19.9104301508], [110.330848033, 19.9041438275], [110.330592708, 19.9043328203], [110.330592708, 19.9043328203], [110.330592708, 19.9043328203], [110.331221412, 19.9038674511], [110.331221412, 19.9038674511], [110.331221412, 19.9038674511], [110.332860995, 19.9009149081], [110.332860995, 19.9009149081], [110.334363978, 19.8995963428], [110.334363978, 19.8995963428], [110.33496898, 19.8987231922], [110.33496898, 19.8987231922], [110.335343085, 19.8978074034], [110.335354759, 19.8973528391], [110.335354759, 19.8973528391], [110.334017584, 19.8967878337], [110.333837695, 19.8966564307], [110.333837695, 19.8966564307], [110.333048673, 19.8961966001], [110.331985194, 19.8949915334], [110.331985194, 19.8949915334], [110.331985194, 19.8949915334], [110.331985194, 19.8949915334], [110.3296804, 19.8924548], [110.3296804, 19.8924548], [110.329924691, 19.8924786273], [110.328372876, 19.8921615448], [110.328112056, 19.891862796], [110.328112056, 19.891862796], [110.327383742, 19.8906404676], [110.32718034, 19.8894163874], [110.32718034, 19.8894163874], [110.32718034, 19.8894163874], [110.32718034, 19.8894163874], [110.322727147, 19.8866257169], [110.322727147, 19.8866257169], [110.321973716, 19.886756388], [110.321973716, 19.886756388], [110.319690589, 19.8872176316], [110.319690589, 19.8872176316], [110.317318436, 19.8869077401], [110.317318436, 19.8869077401], [110.315070049, 19.8856321237], [110.313861842, 19.8850285094], [110.313861842, 19.8850285094], [110.312003061, 19.8847717122], [110.311442211, 19.8845878748], [110.311442211, 19.8845878748], [110.311442211, 19.8845878748], [110.311681622, 19.8836353273], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.3115626, 19.8831949], [110.311564147, 19.883196742], [110.311564147, 19.883196742], [110.311564147, 19.883196742], [110.311564147, 19.883196742], [110.311565036, 19.8831978012], [110.3115626, 19.8831949], [110.310916266, 19.8829835483], [110.310087477, 19.8832663604], [110.310087477, 19.8832663604], [110.308760148, 19.8840298804], [110.308439, 19.8843362], [110.306886833, 19.8844714167], [110.306886833, 19.8844714167], [110.30545622, 19.8853282838], [110.30545622, 19.8853282838], [110.303898852, 19.8861332083], [110.303898852, 19.8861332083], [110.302103855, 19.8855358653], [110.302103855, 19.8855358653], [110.29966824, 19.8854709492], [110.29966824, 19.8854709492], [110.29775203, 19.8854186753], [110.29775203, 19.8854186753], [110.296470662, 19.8857115213], [110.296470662, 19.8857115213], [110.293811234, 19.8851697106], [110.29178161, 19.8852380851], [110.29178161, 19.8852380851], [110.290002278, 19.8853904208], [110.290002278, 19.8853904208], [110.288203096, 19.8860997428], [110.288203096, 19.8860997428], [110.287205452, 19.8865361765], [110.287205452, 19.8865361765], [110.285980254, 19.8879581131], [110.284477829, 19.8890070468], [110.284477829, 19.8890070468], [110.282810286, 19.8895795368], [110.282810286, 19.8895795368], [110.280181108, 19.8906629522], [110.280181108, 19.8906629522], [110.280181108, 19.8906629522], [110.280181108, 19.8906629522], [110.276627733, 19.8907526474], [110.276627733, 19.8907526474], [110.276627733, 19.8907526474], [110.276627733, 19.8907526474], [110.271918098, 19.8912430886], [110.271918098, 19.8912430886], [110.271097737, 19.8913419419], [110.271097737, 19.8913419419], [110.267890966, 19.8917821004], [110.267890966, 19.8917821004], [110.266489916, 19.8922144644], [110.266489916, 19.8922144644], [110.265493434, 19.8926522316], [110.265493434, 19.8926522316], [110.264912649, 19.892717688], [110.264912649, 19.892717688], [110.264708348, 19.8927124483], [110.264717419, 19.8927126809], [110.264717419, 19.8927126809], [110.264718418, 19.8927127066], [110.264718418, 19.8927127066], [110.264718444, 19.8927127072], [110.264718444, 19.8927127072], [110.264718444, 19.8927127072], [110.264718444, 19.8927127072], [110.264718444, 19.8927127072], [110.264718469, 19.8927127079], [110.264718469, 19.8927127079], [110.264719469, 19.8927127335], [110.264719469, 19.8927127335], [110.264719469, 19.8927127335], [110.264719469, 19.8927127335], [110.264719494, 19.8927127342], [110.264719494, 19.8927127342], [110.264719494, 19.8927127342], [110.264720494, 19.8927127598], [110.264720494, 19.8927127598], [110.264719494, 19.8927127342], [110.264719494, 19.8927127342], [110.264719494, 19.8927127342], [110.264720494, 19.8927127598], [110.264720494, 19.8927127598], [110.264720494, 19.8927127598], [110.264720519, 19.8927127605], [110.264728514, 19.8927129655], [110.264728514, 19.8927129655], [110.264863425, 19.8927164256], [110.264863425, 19.8927164256], [110.265572957, 19.8926416489], [110.265572957, 19.8926416489], [110.266459113, 19.8922294144]]}}, {"type": "Feature", "properties": {"id": "2", "cumu_prob": null, "duration": "10 \u2026(244 values)", "timestamp": "2.023010617e+13 \u2026(245 values)", "point_count": 245, "label_lon": 110.3343831, "label_lat": 19.9379091}, "geometry": {"type": "LineString", "coordinates": [[110.338681293, 20.0197393524], [110.338680882, 20.0197271047], [110.338680882, 20.0197271047], [110.337179416, 20.0195304733], [110.336664396, 20.0195368787], [110.336664396, 20.0195368787], [110.336664396, 20.0195368787], [110.329985722, 20.0195208564], [110.329985722, 20.0195208564], [110.329985722, 20.0195208564], [110.331049983, 20.0185169733], [110.331674162, 20.0171117251], [110.331674162, 20.0171117251], [110.331674162, 20.0171117251], [110.333015773, 20.0143481636], [110.333080234, 20.0142051181], [110.333080234, 20.0142051181], [110.333080234, 20.0142051181], [110.334126243, 20.011853636], [110.334126243, 20.011853636], [110.334126243, 20.011853636], [110.335082471, 20.0086177919], [110.335082471, 20.0086177919], [110.335082471, 20.0086177919], [110.335082471, 20.0086177919], [110.335305773, 20.0067970795], [110.335316871, 20.0066890895], [110.335354065, 20.0063271648], [110.335354065, 20.0063271648], [110.335354065, 20.0063271648], [110.335657522, 20.0033743343], [110.335657522, 20.0033743343], [110.335657522, 20.0033743343], [110.335686416, 20.0030931732], [110.335686416, 20.0030931732], [110.335686427, 20.0030930715], [110.335686427, 20.0030930715], [110.335686427, 20.0030930715], [110.335686427, 20.0030930715], [110.335686427, 20.0030930715], [110.335809599, 20.0018943154], [110.335809599, 20.0018943154], [110.335809599, 20.0018943154], [110.336122044, 19.9992143754], [110.336122044, 19.9992143754], [110.336318719, 19.9974804311], [110.336318719, 19.9974804311], [110.336318719, 19.9974804311], [110.336389221, 19.9968588699], [110.336389221, 19.9968588699], [110.336389221, 19.9968588699], [110.336389333, 19.9968578826], [110.336389333, 19.9968578826], [110.336389333, 19.9968578826], [110.336389333, 19.9968578826], [110.336389333, 19.9968578826], [110.336394318, 19.996534307], [110.336394318, 19.996534307], [110.336394318, 19.996534307], [110.336847693, 19.9928307614], [110.33688801, 19.9924743635], [110.33713268, 19.9903113442], [110.33713268, 19.9903113442], [110.337273863, 19.9890632059], [110.337273863, 19.9890632059], [110.337273863, 19.9890632059], [110.33755278, 19.9865256306], [110.33755278, 19.9865256306], [110.337738679, 19.9848214742], [110.337738679, 19.9848214742], [110.337990862, 19.982510637], [110.337990862, 19.982510637], [110.338068594, 19.9817984249], [110.338068594, 19.9817984249], [110.338068594, 19.9817984249], [110.338086704, 19.9816324642], [110.338086704, 19.9816324642], [110.338086704, 19.9816324642], [110.338086704, 19.9816324642], [110.338370264, 19.9795344475], [110.338370264, 19.9795344475], [110.338370264, 19.9795344475], [110.3390608, 19.9760263], [110.3390608, 19.9760263], [110.3390608, 19.9760263], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.3399457, 19.972243], [110.339951387, 19.9720323603], [110.339951387, 19.9720323603], [110.339993206, 19.9704833295], [110.339993206, 19.9704833295], [110.340059707, 19.9680200709], [110.340059707, 19.9680200709], [110.339972129, 19.9661779171], [110.339972129, 19.9661779171], [110.340072875, 19.964119981], [110.340072875, 19.964119981], [110.340077655, 19.9608139995], [110.3400783, 19.9603678], [110.3400783, 19.9603678], [110.3400783, 19.9603678], [110.3400783, 19.9603678], [110.341931467, 19.9506482406], [110.342119965, 19.9498427191], [110.342119965, 19.9498427191], [110.342119965, 19.9498427191], [110.342809262, 19.9446934832], [110.342809262, 19.9446934832], [110.342809262, 19.9446934832], [110.341445725, 19.9401750023], [110.341445725, 19.9401750023], [110.341445725, 19.9401750023], [110.337717893, 19.9387463315], [110.336953934, 19.9385750701], [110.3343831, 19.9379091], [110.3343831, 19.9379091], [110.3343831, 19.9379091], [110.3343831, 19.9379091], [110.327703883, 19.9365322297], [110.3225538, 19.9362523551], [110.3225538, 19.9362523551], [110.317445971, 19.9361906969], [110.316543459, 19.9362249238], [110.316543459, 19.9362249238], [110.310725332, 19.936723264], [110.306156612, 19.937486615], [110.306156612, 19.937486615], [110.306156612, 19.937486615], [110.306156612, 19.937486615], [110.295939354, 19.9400105145], [110.295939354, 19.9400105145], [110.292246015, 19.9409364451], [110.292246015, 19.9409364451], [110.292246015, 19.9409364451], [110.292246015, 19.9409364451], [110.284401385, 19.9430576732], [110.284401385, 19.9430576732], [110.284401385, 19.9430576732], [110.284401385, 19.9430576732], [110.28372183, 19.9427381065], [110.28372183, 19.9427381065], [110.28372183, 19.9427381065], [110.281333276, 19.9379785958], [110.280426257, 19.9364074268], [110.280426257, 19.9364074268], [110.277980474, 19.9348026153], [110.277980474, 19.9348026153], [110.276827892, 19.9279244157], [110.276827892, 19.9279244157], [110.27485027, 19.9225358062], [110.2740056, 19.9208806439], [110.272074568, 19.9173704488], [110.272074568, 19.9173704488], [110.268950953, 19.9132987341], [110.268950953, 19.9132987341], [110.264665591, 19.908826787], [110.264665591, 19.908826787], [110.2636861, 19.9073409], [110.2636861, 19.9073409], [110.2532675, 19.8942358], [110.2532675, 19.8942358], [110.2532675, 19.8942358], [110.2532675, 19.8942358], [110.245063374, 19.893485738], [110.245063374, 19.893485738], [110.240866726, 19.8935681493], [110.240866726, 19.8935681493], [110.240866726, 19.8935681493], [110.234487106, 19.8812648978], [110.234487106, 19.8812648978], [110.234487106, 19.8812648978], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.210921795, 19.8706230062], [110.210921795, 19.8706230062], [110.210921795, 19.8706230062], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2013118, 19.7981293], [110.2013118, 19.7981293], [110.2013118, 19.7981293], [110.2010566, 19.7960289], [110.201166795, 19.795786919], [110.201166795, 19.795786919], [110.201166795, 19.795786919], [110.2030286, 19.7900384], [110.2030286, 19.7900384], [110.2030286, 19.7900384], [110.2035141, 19.7892425], [110.2035141, 19.7892425], [110.2035141, 19.7892425], [110.2064171, 19.7840572], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.2139967, 19.7375606], [110.2139967, 19.7375606], [110.2139967, 19.7375606], [110.2139967, 19.7375606], [110.2100238, 19.7285175], [110.2100238, 19.7285175], [110.2100238, 19.7285175], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109], [110.2069076, 19.7210109]]}}, {"type": "Feature", "properties": {"id": "3", "cumu_prob": null, "duration": "10 \u2026(465 values)", "timestamp": "2.02301061706e+13 \u2026(466 values)", "point_count": 466, "label_lon": 110.3381964, "label_lat": 19.9777643}, "geometry": {"type": "LineString", "coordinates": [[110.2202233, 19.7209406], [110.2202233, 19.7209406], [110.2202233, 19.7209406], [110.2202233, 19.7209406], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2166242, 19.7315157], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.2148246, 19.7394493], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.207288, 19.7822298], [110.2035141, 19.7892425], [110.2035141, 19.7892425], [110.2030286, 19.7900384], [110.2030286, 19.7900384], [110.2027283, 19.7912111], [110.2027283, 19.7912111], [110.2026833, 19.7916962], [110.2010566, 19.7960289], [110.2010566, 19.7960289], [110.2012017, 19.7978326], [110.2012017, 19.7978326], [110.2013118, 19.7981293], [110.2013118, 19.7981293], [110.2013118, 19.7981293], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.2023379, 19.8091346], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.1967653, 19.8497391], [110.2101135, 19.8703239], [110.2101135, 19.8703239], [110.2101135, 19.8703239], [110.2101135, 19.8703239], [110.2221538, 19.8823641], [110.2221538, 19.8823641], [110.2221538, 19.8823641], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.2232189, 19.8822794], [110.2274342, 19.881828], [110.2274342, 19.881828], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.2301944, 19.8815459], [110.233720588, 19.8813334729], [110.233720588, 19.8813334729], [110.233720588, 19.8813334729], [110.2394678, 19.8934982], [110.2394678, 19.8934982], [110.242798508, 19.8939847181], [110.242798508, 19.8939847181], [110.247034257, 19.8938864313], [110.247034257, 19.8938864313], [110.249902814, 19.8944353629], [110.249902814, 19.8944353629], [110.249902814, 19.8944353629], [110.2636861, 19.9073409], [110.2636861, 19.9073409], [110.2636861, 19.9073409], [110.2636861, 19.9073409], [110.264421415, 19.9086358807], [110.264421415, 19.9086358807], [110.268115523, 19.9120621267], [110.268115523, 19.9120621267], [110.271089743, 19.9156033872], [110.273449693, 19.9192928614], [110.273449693, 19.9192928614], [110.275676542, 19.9240022338], [110.275994889, 19.9248985039], [110.275994889, 19.9248985039], [110.277116658, 19.9280567171], [110.278856652, 19.9325086405], [110.279314181, 19.9336186054], [110.279314181, 19.9336186054], [110.280746534, 19.9365998145], [110.282015597, 19.9392974193], [110.282015597, 19.9392974193], [110.284727105, 19.9410678864], [110.284727105, 19.9410678864], [110.287723122, 19.9416249203], [110.287723122, 19.9416249203], [110.290450893, 19.941076242], [110.290450893, 19.941076242], [110.293557, 19.9404095], [110.293557, 19.9404095], [110.293557, 19.9404095], [110.300349461, 19.9387110066], [110.300549797, 19.938660336], [110.300549797, 19.938660336], [110.300549797, 19.938660336], [110.307061037, 19.9371334442], [110.307061037, 19.9371334442], [110.307061037, 19.9371334442], [110.312968656, 19.9363028236], [110.312968656, 19.9363028236], [110.312968656, 19.9363028236], [110.31877009, 19.9359904368], [110.319429057, 19.9359951627], [110.321684833, 19.9360490167], [110.321684833, 19.9360490167], [110.321684833, 19.9360490167], [110.326256711, 19.9363617535], [110.327700212, 19.9365317488], [110.327700212, 19.9365317488], [110.327700212, 19.9365317488], [110.33198721, 19.937220211], [110.33198721, 19.937220211], [110.33198721, 19.937220211], [110.33752424, 19.9383051395], [110.33752424, 19.9383051395], [110.339791665, 19.9387744389], [110.34206572, 19.9392647056], [110.34206572, 19.9392647056], [110.34206572, 19.9392647056], [110.34206572, 19.9392647056], [110.34431673, 19.9386103861], [110.3438573, 19.9392505], [110.3438573, 19.9392505], [110.3438573, 19.9392505], [110.343244734, 19.9437599443], [110.343244734, 19.9437599443], [110.343244734, 19.9437599443], [110.343244734, 19.9437599443], [110.342511591, 19.9490355418], [110.342511591, 19.9490355418], [110.342511591, 19.9490355418], [110.342366976, 19.949785061], [110.342366976, 19.949785061], [110.342366976, 19.949785061], [110.341544269, 19.9532039664], [110.341544269, 19.9532039664], [110.34083578, 19.9556157786], [110.34083578, 19.9556157786], [110.34083578, 19.9556157786], [110.34083578, 19.9556157786], [110.340262, 19.961147], [110.340262, 19.961147], [110.340262, 19.961147], [110.340262, 19.965818], [110.340262, 19.965818], [110.340262, 19.965818], [110.340216955, 19.9696398701], [110.340216955, 19.9696398701], [110.340216955, 19.9696398701], [110.340216955, 19.9696398701], [110.340147876, 19.9720269257], [110.340147876, 19.9720269257], [110.340147876, 19.9720269257], [110.340124704, 19.9724544275], [110.340107624, 19.9725891779], [110.34009694, 19.9726734715], [110.34009694, 19.9726734715], [110.340073512, 19.9728583184], [110.340073512, 19.9728583184], [110.339962183, 19.9734712197], [110.339872994, 19.9737709981], [110.339872994, 19.9737709981], [110.339836389, 19.973894033], [110.339776949, 19.9740938195], [110.339776949, 19.9740938195], [110.339702526, 19.9743439663], [110.339691733, 19.9743802428], [110.339691733, 19.9743802428], [110.339679417, 19.9744216366], [110.339679417, 19.9744216366], [110.339607876, 19.9746620955], [110.339607876, 19.9746620955], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.3390745, 19.9759644], [110.339101651, 19.9758379736], [110.339101651, 19.9758379736], [110.339101651, 19.9758379736], [110.338895885, 19.9767135391], [110.338895885, 19.9767135391], [110.338895885, 19.9767135391], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3381964, 19.9777643], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3385108, 19.9783962], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3384975, 19.9784565], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385641, 19.9800971], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.3385308, 19.9803541], [110.338556137, 19.9805903133], [110.338556137, 19.9805903133], [110.338562934, 19.980589902], [110.338555499, 19.9811708588], [110.338555499, 19.9811708588], [110.338555499, 19.9811708588], [110.338090039, 19.9838338339], [110.338090039, 19.9838338339], [110.337939261, 19.9851808148], [110.337939261, 19.9851808148], [110.33779207, 19.9865075748], [110.33779207, 19.9865075748], [110.337720665, 19.987151217], [110.337720665, 19.987151217], [110.337720067, 19.9871566007], [110.337720067, 19.9871566007], [110.337719872, 19.9871583587], [110.337719653, 19.9871603359], [110.337719653, 19.9871603359], [110.337719519, 19.9871615444], [110.337719519, 19.9871615444], [110.337719373, 19.9871628626], [110.337719373, 19.9871628626], [110.337719154, 19.9871648367], [110.337719154, 19.9871648367], [110.337642662, 19.9878543276], [110.337642662, 19.9878543276], [110.337517938, 19.9890467292], [110.337517938, 19.9890467292], [110.337517938, 19.9890467292], [110.337203777, 19.9920121385], [110.337203777, 19.9920121385], [110.337203777, 19.9920121385], [110.336918287, 19.9947002695], [110.336918287, 19.9947002695], [110.336810035, 19.9956951126], [110.336810035, 19.9956951126], [110.336810035, 19.9956951126], [110.336810035, 19.9956951126], [110.336487778, 19.9987710614], [110.336487778, 19.9987710614], [110.336487778, 19.9987710614], [110.336275572, 20.0007738241], [110.336275434, 20.0007751274], [110.336275423, 20.0007752322], [110.336275423, 20.0007752322], [110.336275423, 20.0007752322], [110.336275423, 20.0007752322], [110.336228789, 20.001215271], [110.336228789, 20.001215271], [110.336225794, 20.0012435297], [110.336225794, 20.0012435297], [110.336225794, 20.0012435297], [110.336225794, 20.0012435297], [110.336225689, 20.0012445186], [110.336225689, 20.0012445186], [110.336225689, 20.0012445186], [110.336225689, 20.0012445186], [110.336225689, 20.0012445186], [110.336225689, 20.0012445186], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.3361849, 20.0015837], [110.335852851, 20.0015464815], [110.335852851, 20.0015464815], [110.333886404, 20.0006592634], [110.333886404, 20.0006592634], [110.3320582, 20.0000724], [110.3320582, 20.0000724], [110.330113323, 19.999073469], [110.330113323, 19.999073469], [110.328463959, 19.9983212674], [110.328463959, 19.9983212674], [110.325307755, 19.9974679192], [110.324290115, 19.9974737524], [110.323189075, 19.9974786183], [110.322651112, 19.9974818078], [110.321777059, 19.9974869898], [110.320804076, 19.9974927585], [110.3200718, 19.9974971], [110.3200291, 19.9972691], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.3160413, 19.9974803], [110.316041027, 19.9975166986], [110.3159744, 19.9974797], [110.315384004, 19.9974750825], [110.314642003, 19.9974749112], [110.313867004, 19.9974747323], [110.3135356, 19.9972854], [110.3135356, 19.9972854], [110.3113214, 19.9957365], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.3092881, 19.9971891], [110.309272217, 19.9972685546], [110.309246752, 19.997508372], [110.308817455, 19.997380325], [110.307918438, 19.9973260624], [110.307314882, 19.9972693336], [110.306733533, 19.9972146921], [110.305956662, 19.9971416734], [110.304954925, 19.9970475192], [110.304115917, 19.9969893111], [110.303180972, 19.996930452], [110.302538309, 19.9968991366], [110.302097502, 19.9968955355], [110.300730729, 19.997333649], [110.300728525, 19.9974797666], [110.300728525, 19.9974797666], [110.300728525, 19.9974797666], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401], [110.3006459, 19.9988401]]}}, {"type": "Feature", "properties": {"id": "4", "cumu_prob": null, "duration": "50 \u2026(294 values)", "timestamp": "2.02301061811e+13 \u2026(295 values)", "point_count": 295, "label_lon": 110.263573215, "label_lat": 19.8912679424}, "geometry": {"type": "LineString", "coordinates": [[110.2017497, 19.9187201], [110.2017497, 19.9187201], [110.201737575, 19.9185354354], [110.202625246, 19.9197215967], [110.202625246, 19.9197215967], [110.202798, 19.9199032], [110.202798, 19.9199032], [110.202798, 19.9199032], [110.202798, 19.9199032], [110.202798, 19.9199032], [110.202798, 19.9199032], [110.204418198, 19.9209286236], [110.204428373, 19.9209326736], [110.204428373, 19.9209326736], [110.205438066, 19.921564338], [110.205438066, 19.921564338], [110.206559257, 19.9214897437], [110.206559257, 19.9214897437], [110.206559257, 19.9214897437], [110.208273727, 19.9213963289], [110.208273727, 19.9213963289], [110.209072589, 19.9215597897], [110.211232151, 19.9214305448], [110.211599619, 19.921328625], [110.211599619, 19.921328625], [110.213353334, 19.9212408017], [110.214511814, 19.9221989749], [110.214962201, 19.9225898981], [110.214962201, 19.9225898981], [110.215962541, 19.9228458059], [110.217037395, 19.9225322991], [110.217037395, 19.9225322991], [110.218101367, 19.9257060434], [110.218101367, 19.9257060434], [110.2176454, 19.9267088131], [110.21786978, 19.9276565762], [110.21786978, 19.9276565762], [110.218700702, 19.9294152507], [110.218700702, 19.9294152507], [110.219687868, 19.9301769105], [110.220740351, 19.9301071979], [110.220740351, 19.9301071979], [110.220740351, 19.9301071979], [110.223071679, 19.929947612], [110.22408457, 19.9298920946], [110.224726977, 19.929899704], [110.224726977, 19.929899704], [110.224726977, 19.929899704], [110.228446218, 19.9305692347], [110.228446218, 19.9305692347], [110.228446218, 19.9305692347], [110.232013362, 19.9313800176], [110.232846279, 19.9315031131], [110.232846279, 19.9315031131], [110.232846279, 19.9315031131], [110.23521, 19.9328283], [110.23521, 19.9328283], [110.238286588, 19.9347231443], [110.23832522, 19.9349535637], [110.238203593, 19.9352403213], [110.240614828, 19.9369079394], [110.240614828, 19.9369079394], [110.240614828, 19.9369079394], [110.244539428, 19.9377135888], [110.244539428, 19.9377135888], [110.244539428, 19.9377135888], [110.248468682, 19.9384549652], [110.248873342, 19.9384253239], [110.248873342, 19.9384253239], [110.248873342, 19.9384253239], [110.253755754, 19.9380676878], [110.253755754, 19.9380676878], [110.253755754, 19.9380676878], [110.256310076, 19.9377833571], [110.256393411, 19.9373868302], [110.2564217, 19.9373796], [110.2564217, 19.9373796], [110.2564217, 19.9373796], [110.2564217, 19.9373796], [110.259239541, 19.9322433376], [110.259239541, 19.9322433376], [110.259239541, 19.9322433376], [110.261230619, 19.9278666936], [110.261230619, 19.9278666936], [110.261230619, 19.9278666936], [110.261894601, 19.9230071681], [110.261894601, 19.9230071681], [110.261894601, 19.9230071681], [110.261894601, 19.9230071681], [110.262580229, 19.9176481674], [110.262580229, 19.9176481674], [110.262840532, 19.9156422749], [110.262840532, 19.9156422749], [110.262840532, 19.9156422749], [110.262840532, 19.9156422749], [110.263955142, 19.9110731042], [110.264563164, 19.9091506238], [110.264563164, 19.9091506238], [110.264563164, 19.9091506238], [110.26552732, 19.9057443557], [110.26552732, 19.9057443557], [110.26552732, 19.9057443557], [110.26552732, 19.9057443557], [110.265193564, 19.9024070688], [110.265193564, 19.9024070688], [110.264628733, 19.9007617918], [110.264309483, 19.8991780388], [110.264309483, 19.8991780388], [110.2643131, 19.8991967], [110.2643131, 19.8991967], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629402, 19.8942831], [110.2629601, 19.8944412052], [110.262911653, 19.8939771257], [110.26290854, 19.893943763], [110.26290854, 19.893943763], [110.262894817, 19.8937910136], [110.262894817, 19.8937910136], [110.262876879, 19.8935500512], [110.26287167, 19.8934800766], [110.262860222, 19.8933262911], [110.262860222, 19.8933262911], [110.262836348, 19.8929111511], [110.262836348, 19.8929111511], [110.26283179, 19.8925567827], [110.26283179, 19.8925567827], [110.262941642, 19.8921987555], [110.263004518, 19.8920805082], [110.263142874, 19.8918704674], [110.263142874, 19.8918704674], [110.263461512, 19.8914245076], [110.263461512, 19.8914245076], [110.263477926, 19.8914015171], [110.263477926, 19.8914015171], [110.263527101, 19.8913326396], [110.263527101, 19.8913326396], [110.263574357, 19.8912663335], [110.263573352, 19.8912677496], [110.263573352, 19.8912677496], [110.263573352, 19.8912677496], [110.263573352, 19.8912677496], [110.263573215, 19.8912679424], [110.263573215, 19.8912679424], [110.263573215, 19.8912679424], [110.26357355, 19.8912674704], [110.26357355, 19.8912674704], [110.26357355, 19.8912674704], [110.26357355, 19.8912674704], [110.26357355, 19.8912674704], [110.26357355, 19.8912674704], [110.263574022, 19.8912668055], [110.263574022, 19.8912668055], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409405, 19.8926383546], [110.263409405, 19.8926383546], [110.263408411, 19.8926382723], [110.263408411, 19.8926382723], [110.263408494, 19.8926382791], [110.263408494, 19.8926382791], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.263409487, 19.8926383615], [110.26341048, 19.8926384438], [110.26341048, 19.8926384438], [110.26341048, 19.8926384438], [110.26341048, 19.8926384438], [110.26341048, 19.8926384438], [110.26341048, 19.8926384438], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263411473, 19.8926385261], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263412466, 19.8926386085], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263413542, 19.8926386977], [110.263414535, 19.89263878], [110.263414535, 19.89263878], [110.263414535, 19.89263878], [110.263414535, 19.89263878], [110.263415611, 19.8926388692], [110.263415611, 19.8926388692], [110.263415611, 19.8926388692], [110.263415611, 19.8926388692], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263416604, 19.8926389515], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263417679, 19.8926390407], [110.263418673, 19.892639123], [110.263418673, 19.892639123], [110.263418673, 19.892639123], [110.263575957, 19.8912640797], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.26357582, 19.8912642725], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575485, 19.8912647445], [110.263575013, 19.8912654094], [110.263575013, 19.8912654094], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574678, 19.8912658814], [110.263574206, 19.8912665462], [110.263574206, 19.8912665462], [110.263574206, 19.8912665462], [110.263574541, 19.8912660742], [110.263574541, 19.8912660742], [110.263574541, 19.8912660742], [110.263574541, 19.8912660742], [110.263574541, 19.8912660742], [110.263574876, 19.8912656022]]}}, {"type": "Feature", "properties": {"id": "5", "cumu_prob": null, "duration": "10 \u2026(209 values)", "timestamp": "2.02301061808e+13 \u2026(210 values)", "point_count": 210, "label_lon": 110.290187563, "label_lat": 19.9556533228}, "geometry": {"type": "LineString", "coordinates": [[110.287580008, 19.9594601486], [110.287527625, 19.9594417133], [110.287526735, 19.9594414002], [110.287524016, 19.9594404432], [110.287524016, 19.9594404432], [110.287520457, 19.9594391907], [110.287520457, 19.9594391907], [110.287517474, 19.959438141], [110.287517474, 19.959438141], [110.287386342, 19.9593919916], [110.287366378, 19.959409971], [110.287325218, 19.9593704762], [110.287300302, 19.9593617053], [110.286944754, 19.959236551], [110.2851813, 19.9598695], [110.2851813, 19.9598695], [110.285178339, 19.95987642], [110.285157612, 19.9599248563], [110.2850653, 19.9601405744], [110.284914145, 19.9604938008], [110.283885134, 19.9606040032], [110.283841448, 19.9607156644], [110.283838087, 19.9607240532], [110.283841402, 19.9607157788], [110.283841402, 19.9607157788], [110.283841402, 19.9607157788], [110.283842578, 19.960712843], [110.283842578, 19.960712843], [110.283842578, 19.960712843], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.2838454, 19.9607058], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837085, 19.9607265536], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283837223, 19.9607262084], [110.283835621, 19.9607302078], [110.283833376, 19.9607358125], [110.283833376, 19.9607358125], [110.283943968, 19.9607397777], [110.283943968, 19.9607397777], [110.284164687, 19.9598878003], [110.284164687, 19.9598878003], [110.284594824, 19.9587859044], [110.284594824, 19.9587859044], [110.2851224, 19.9585952], [110.285864345, 19.9588563698], [110.286027652, 19.9589138169], [110.287132354, 19.9593025856], [110.28784695, 19.9595540937], [110.28784695, 19.9595540937], [110.289232862, 19.9600418678], [110.289232862, 19.9600418678], [110.289664176, 19.960165303], [110.289895, 19.9602089], [110.289895, 19.9602089], [110.290246718, 19.9580931227], [110.290246718, 19.9580931227], [110.290187563, 19.9556533228], [110.290187563, 19.9556533228], [110.289722263, 19.9531359148], [110.289312325, 19.9517951139], [110.289312325, 19.9517951139], [110.288328749, 19.9497084054], [110.288328749, 19.9497084054], [110.287013726, 19.9475994486], [110.285532234, 19.9453866778], [110.285532234, 19.9453866778], [110.28408197, 19.9431429738], [110.28408197, 19.9431429738], [110.283135912, 19.9414717601], [110.283135912, 19.9414717601], [110.282444636, 19.9434192602], [110.282444636, 19.9434192602], [110.284918093, 19.9426126357], [110.287454376, 19.9419626044], [110.287454376, 19.9419626044], [110.289835737, 19.9413604232], [110.289835737, 19.9413604232], [110.29248195, 19.9406955715], [110.29248195, 19.9406955715], [110.295477776, 19.9399326865], [110.299080298, 19.9390320131], [110.299080298, 19.9390320131], [110.302821313, 19.9380927451], [110.302821313, 19.9380927451], [110.307930192, 19.9369779013], [110.307930192, 19.9369779013], [110.312146739, 19.9363704674], [110.312146739, 19.9363704674], [110.316674982, 19.9360404799], [110.320607136, 19.9360130417], [110.320607136, 19.9360130417], [110.324888272, 19.9362371169], [110.324888272, 19.9362371169], [110.328994937, 19.9367099511], [110.328994937, 19.9367099511], [110.333073782, 19.937447878], [110.333073782, 19.937447878], [110.333073782, 19.937447878], [110.338170715, 19.9384394091], [110.340540319, 19.938876377], [110.340540319, 19.938876377], [110.343603749, 19.9396160284], [110.343603749, 19.9396160284], [110.346144846, 19.9401544087], [110.346144846, 19.9401544087], [110.348750714, 19.9406986216], [110.348750714, 19.9406986216], [110.351560525, 19.9412147405], [110.351560525, 19.9412147405], [110.354690957, 19.9416730164], [110.357647884, 19.9419082613], [110.357647884, 19.9419082613], [110.360153609, 19.9415005132], [110.360153609, 19.9415005132], [110.358623442, 19.9405389848], [110.358623442, 19.9405389848], [110.358148309, 19.9423671525], [110.358148309, 19.9423671525], [110.358732187, 19.9454650322], [110.358732187, 19.9454650322], [110.359319145, 19.9496477133], [110.359319145, 19.9496477133], [110.360115696, 19.9522689606], [110.360115696, 19.9522689606], [110.361479087, 19.9560898564], [110.361479087, 19.9560898564], [110.362483127, 19.9588734105], [110.362483127, 19.9588734105], [110.363320029, 19.961240999], [110.364184387, 19.963624692], [110.364184387, 19.963624692], [110.365182828, 19.9664034555], [110.365182828, 19.9664034555], [110.366281793, 19.9694569331], [110.366281793, 19.9694569331], [110.367210469, 19.9721387173], [110.367498871, 19.9734840016], [110.367498871, 19.9734840016], [110.36764499, 19.9757594737], [110.367625081, 19.9784135093], [110.367625081, 19.9784135093], [110.367674694, 19.9804040179], [110.367674694, 19.9804040179], [110.368610799, 19.9814548389], [110.368610799, 19.9814548389], [110.367910304, 19.9803626063], [110.365803257, 19.9803589583], [110.365546255, 19.9803585145], [110.363308114, 19.9803741809], [110.363229143, 19.9803748123], [110.362407788, 19.9803813796], [110.362407788, 19.9803813796], [110.3621679, 19.9818057], [110.3621679, 19.9818057], [110.36224602, 19.9830613593], [110.362387041, 19.9830614665], [110.363063049, 19.9830619802], [110.363136052, 19.9830620357], [110.363274033, 19.9830621405], [110.363274033, 19.9830621405], [110.363268022, 19.983062136]]}}]};
  const bounds = [[110.1967653, 19.7209406], [110.368610799, 20.0197393524]];
  const routeCenter = [110.2826880495, 19.8703399762];
  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/satellite-streets-v12',
    center: routeCenter,
    zoom: 12,
    pitch: 60,
    bearing: -20
  });

  map.dragRotate.enable();
  if (map.touchZoomRotate) {
    map.touchZoomRotate.enableRotate();
    map.touchZoomRotate.enablePitch();
  }

  class ViewToggleControl {
    onAdd(mapInstance) {
      this._map = mapInstance;
      this._is3D = true;
      const container = document.createElement('div');
      container.className = 'mapboxgl-ctrl mapboxgl-ctrl-group';
      const button = document.createElement('button');
      button.type = 'button';
      button.setAttribute('aria-label', 'Toggle camera view');
      button.textContent = '切换视角';
      button.onclick = () => {
        this._is3D = !this._is3D;
        mapInstance.easeTo({
          pitch: this._is3D ? 60 : 0,
          bearing: this._is3D ? -20 : 0,
          duration: 800
        });
      };
      container.appendChild(button);
      this._container = container;
      return this._container;
    }

    onRemove() {
      if (this._container?.parentNode) {
        this._container.parentNode.removeChild(this._container);
      }
      this._map = undefined;
    }
  }

  map.on('load', () => {
    map.addControl(new mapboxgl.NavigationControl({ visualizePitch: true }), 'top-right');
    map.addControl(new mapboxgl.FullscreenControl(), 'top-right');
    map.addControl(new ViewToggleControl(), 'top-left');

    map.addSource('mapbox-dem', {
      type: 'raster-dem',
      url: 'mapbox://mapbox.mapbox-terrain-dem-v1',
      tileSize: 512,
      maxzoom: 14
    });
    map.setTerrain({ source: 'mapbox-dem', exaggeration: 1.4 });

    map.addSource('matched-route', {
      type: 'geojson',
      data: routeGeojson,
      generateId: true
    });

    map.addLayer({
      id: 'matched-route-line',
      type: 'line',
      source: 'matched-route',
      paint: {
        'line-color': [
          'case',
          ['boolean', ['feature-state', 'hover'], false],
          '#f9ff2d',
          ['interpolate', ['linear'], ['coalesce', ['get', 'cumu_prob'], 0],
            0, '#00ffd5',
            0.5, '#7a66ff',
            1, '#ff1f6b'
          ]
        ],
        'line-width': [
          'case',
          ['boolean', ['feature-state', 'hover'], false],
          ['interpolate', ['linear'], ['zoom'],
            10, 14,
            16, 34
          ],
          ['interpolate', ['linear'], ['zoom'],
            10, 10,
            16, 28
          ]
        ],
        'line-opacity': 1.0,
        'line-join': 'round',
        'line-cap': 'round'
      }
    });

    map.addLayer({
      id: 'matched-route-points',
      type: 'circle',
      source: 'matched-route',
      paint: {
        'circle-radius': [
          'case',
          ['boolean', ['feature-state', 'hover'], false],
          ['interpolate', ['linear'], ['zoom'],
            10, 6,
            16, 12
          ],
          ['interpolate', ['linear'], ['zoom'],
            10, 4,
            16, 9
          ]
        ],
        'circle-color': [
          'case',
          ['boolean', ['feature-state', 'hover'], false],
          '#f9ff2d',
          '#00ffd5'
        ],
        'circle-stroke-color': [
          'case',
          ['boolean', ['feature-state', 'hover'], false],
          '#ffffff',
          '#061422'
        ],
        'circle-stroke-width': [
          'interpolate', ['linear'], ['zoom'],
          10, 0.6,
          16, 1.6
        ],
        'circle-opacity': 0.9
      }
    });

    map.addLayer({
      id: 'matched-route-labels',
      type: 'symbol',
      source: 'matched-route',
      layout: {
        'symbol-placement': 'line-center',
        'text-field': ['coalesce', ['get', 'id'], '轨迹'],
        'text-size': 14,
        'text-font': ['Open Sans Semibold', 'Arial Unicode MS Bold'],
        'text-offset': [0, 1.2],
        'text-allow-overlap': false,
        'text-pitch-alignment': 'map'
      },
      paint: {
        'text-color': '#ffffff',
        'text-halo-color': '#0a0a0a',
        'text-halo-width': 1.5,
        'text-opacity': 0.95
      }
    });

    map.addLayer({
      id: '3d-buildings',
      source: 'composite',
      'source-layer': 'building',
      filter: ['==', ['get', 'extrude'], 'true'],
      type: 'fill-extrusion',
      minzoom: 15,
      paint: {
        'fill-extrusion-color': '#aaa',
        'fill-extrusion-height': ['get', 'height'],
        'fill-extrusion-base': ['get', 'min_height'],
        'fill-extrusion-opacity': 0.6
      }
    });

    let hoveredFeatureId = null;
    const popup = new mapboxgl.Popup({ closeButton: false, closeOnClick: false });

    const formatProbability = (value) => {
      const numeric = Number(value);
      return Number.isFinite(numeric) ? numeric.toFixed(3) : 'N/A';
    };

    const buildPopupHTML = (props) => {
      const trajectoryId = (props.id !== undefined && props.id !== null && props.id !== '') ? props.id : '未知';
      const rows = [];
      rows.push('<strong>轨迹: ' + trajectoryId + '</strong>');
      rows.push('累计概率: ' + formatProbability(props.cumu_prob));
      if (props.duration && props.duration !== 'null') {
        rows.push('时长: ' + props.duration);
      }
      if (props.timestamp && props.timestamp !== 'null') {
        rows.push('时间戳: ' + props.timestamp);
      }
      if (props.point_count !== undefined && props.point_count !== null && props.point_count !== 'null') {
        rows.push('轨迹点数: ' + props.point_count);
      }
      return rows.join('<br/>');
    };

    const showHoverInfo = (event) => {
      if (!event.features || !event.features.length) {
        return;
      }
      const feature = event.features[0];
      const featureId = feature.id;
      if (hoveredFeatureId !== null && hoveredFeatureId !== featureId) {
        map.setFeatureState({ source: 'matched-route', id: hoveredFeatureId }, { hover: false });
      }
      hoveredFeatureId = featureId;
      map.setFeatureState({ source: 'matched-route', id: hoveredFeatureId }, { hover: true });
      map.getCanvas().style.cursor = 'pointer';

      const props = feature.properties || {};
      popup.setLngLat(event.lngLat).setHTML(buildPopupHTML(props)).addTo(map);
    };

    const resetHover = () => {
      if (hoveredFeatureId !== null) {
        map.setFeatureState({ source: 'matched-route', id: hoveredFeatureId }, { hover: false });
        hoveredFeatureId = null;
      }
      popup.remove();
      map.getCanvas().style.cursor = '';
    };

    ['mousemove', 'click'].forEach((evtName) => {
      ['matched-route-line', 'matched-route-points'].forEach((layerId) => {
        map.on(evtName, layerId, showHoverInfo);
      });
    });

    ['mouseleave', 'touchend'].forEach((evtName) => {
      ['matched-route-line', 'matched-route-points'].forEach((layerId) => {
        map.on(evtName, layerId, resetHover);
      });
    });

    const staticPopups = [];
    routeGeojson.features.forEach((feature) => {
      const props = feature.properties || {};
      const lon = Number(props.label_lon);
      const lat = Number(props.label_lat);
      if (!Number.isFinite(lon) || !Number.isFinite(lat)) {
        return;
      }
      const popupContent = buildPopupHTML(props);
      const staticPopup = new mapboxgl.Popup({
        closeButton: false,
        closeOnClick: false,
        offset: [0, -12],
        className: 'static-route-popup'
      }).setLngLat([lon, lat]).setHTML(popupContent).addTo(map);
      staticPopups.push(staticPopup);
    });

    const recenterView = () => {
      const hasExtent = bounds[0][0] !== bounds[1][0] || bounds[0][1] !== bounds[1][1];
      if (hasExtent) {
        map.fitBounds(bounds, { padding: 80, maxZoom: 17 });
      } else {
        map.easeTo({
          center: routeCenter,
          zoom: 16,
          duration: 600,
          pitch: map.getPitch(),
          bearing: map.getBearing()
        });
      }
    };

    if (map.isSourceLoaded('matched-route')) {
      recenterView();
    } else {
      const handleSourceData = (event) => {
        if (event.sourceId === 'matched-route' && event.isSourceLoaded) {
          map.off('sourcedata', handleSourceData);
          recenterView();
        }
      };
      map.on('sourcedata', handleSourceData);
    }
  });
</script>
</body>
</html>
